<%- include('partials/header.ejs'); -%>

<header>
    <div>
        <h1 class="display-1">Book Traker</h1>
        <p>The following project allows the user to keep track of the books they have read. The books currently displayed are some of the books that I've read over the years.</p> 

        <div class="formContainer">
            <form action="/edit" method="get">
                <button class="btn btnEd">Edit List</button>
            </form>
             <form action="/add" method="GET">
                <button type="submit" class="btn btnC">Add a book</button>
            </form>
        </div>
       
    </div>
</header>
<main>
    
    <% for(let book of bookList) { %>
        <div class="cnt">
            <img src="https://covers.openlibrary.org/b/isbn/<%= book.isbn %>-M.jpg" alt="Book Cover" class="book-cover">
            <div class="bookInfo">
                <!-- Campo de visualización del nombre del libro -->
                <h3 id="title<%= book.id %>"><%= book.bookname %></h3>
                <!-- Campo de edición del nombre del libro -->
                <input type="text" id="inputTitle<%= book.id %>" name="bookname" value="<%= book.bookname %>" hidden>

                <!-- Campo de visualización del autor -->
                <h5>Author:</h5> <p id="author<%= book.id %>"><%= book.author %></p>
                <!-- Campo de edición del autor -->
                <input type="text" id="inputAuthor<%= book.id %>" name="author" value="<%= book.author %>" hidden>

                <!-- Campo de visualización del género -->
                <h5>Genre:</h5> <p id="genre<%= book.id %>"><%= book.genre %></p>
                <!-- Campo de edición del género -->
                <input type="text" id="inputGenre<%= book.id %>" name="genre" value="<%= book.genre %>" hidden>

                <!-- Campo de visualización del ISBN -->
                <h5>ISBN:</h5> <p id="isbn<%= book.id %>"><%= book.isbn %></p>
                <!-- Campo de edición del ISBN -->
                <input type="text" id="inputIsbn<%= book.id %>" name="isbn" value="<%= book.isbn %>" hidden>

                <!-- Campo de visualización del año leído -->
                <h5>Year Read:</h5> <p id="yearRead<%= book.id %>"><%= book.yearread %></p>
                <!-- Campo de edición del año leído -->
                <input type="number" id="inputYear<%= book.id %>" name="yearread" value="<%= book.yearread %>" hidden>

                <!-- Campo de visualización de la calificación -->
                <h5>Rating:</h5> <p id="rating<%= book.id %>"><%= book.rating %></p>
                <!-- Campo de edición de la calificación -->
                <input type="number" id="inputRating<%= book.id %>" name="rating" value="<%= book.rating %>" hidden>

                <!-- Campo de visualización de la descripción -->
                <h5>Description:</h5> <p id="description<%= book.id %>"><%= book.description %></p>
                <!-- Campo de edición de la descripción -->
                <textarea id="inputDescription<%= book.id %>" name="description" hidden><%= book.description %></textarea>
                
                <!-- Botón de Editar -->
                <button id="edit<%= book.id %>" class="btn btnEd" onclick="handler('<%= book.id %>')">Edit</button>

                <!-- Botón de Guardar cambios -->
                <form action="/edit/<%= book.id %>" method="POST" style="display: inline;">
                    <button id="done<%= book.id %>" type="submit" class="btn btn-success" hidden>Done</button>
                </form>
                
                <!-- Botón de Borrar -->
                <form action="/delete" method="POST" style="display: inline;">
                    <button class="btn btnDe" name="btn<%= book.id %>" value="<%= book.id %>">Delete</button>
                </form>
            </div>  
        </div>
    <% } %>

        <script>
             function handler(id) {
        const fields = ["title", "author", "genre", "isbn", "yearRead", "rating", "description"];
        
        // Ocultar campos de visualización y mostrar inputs de edición
        fields.forEach(field => {
            document.getElementById(field + id).setAttribute("hidden", true);
            document.getElementById("input" + field.charAt(0).toUpperCase() + field.slice(1) + id).removeAttribute("hidden");
        });
        
        // Ocultar botón de Edit y mostrar botón de Done
        document.getElementById("edit" + id).setAttribute("hidden", true);
        document.getElementById("done" + id).removeAttribute("hidden");
    }
        </script>
</main>

<footer>
    
</footer>

</body>
</html>